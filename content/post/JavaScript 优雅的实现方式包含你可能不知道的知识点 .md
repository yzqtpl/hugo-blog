---
title: JavaScript ä¼˜é›…çš„å®ç°æ–¹å¼åŒ…å«ä½ å¯èƒ½ä¸çŸ¥é“çš„çŸ¥è¯†ç‚¹ 
date: 2017-05-11 09:17:00
categories: [ç¼–ç¨‹, å‰ç«¯]
tags: [å‰ç«¯, js]
description:
---

# å‰ç«¯

æ ‡ç­¾ï¼š å¹²è´§

# JavaScript ä¼˜é›…çš„å®ç°æ–¹å¼åŒ…å«ä½ å¯èƒ½ä¸çŸ¥é“çš„çŸ¥è¯†ç‚¹ 

**æœ‰äº›ä¸œè¥¿å¾ˆå¥½ç”¨ï¼Œä½†æ˜¯ä½ æœªå¿…çŸ¥é“ï¼›æœ‰äº›ä¸œè¥¿ä½ å¯èƒ½ç”¨è¿‡ï¼Œä½†æ˜¯ä½ æœªå¿…çŸ¥é“åŸç†ã€‚**

å®ç°ä¸€ä¸ªç›®çš„æœ‰å¤šç§é€”å¾„ï¼Œä¿—è¯è¯´ï¼Œæ¡æ¡å¤§è·¯é€šç½—é©¬ã€‚å¾ˆå¤šå†…å®¹æ¥è‡ªå¹³æ—¶çš„ä¸€äº›æ”¶é›†ä»¥åŠè¿‡å¾€åšå®¢æ–‡ç« åº•ä¸‹çš„ç²¾å½©è¯„è®ºï¼Œæ”¶é›†æ•´ç†æ‹“å±•ä¸€æ³¢ï¼Œå‘æ•£ä¸€ä¸‹å¤§å®¶çš„æ€ç»´ä»¥åŠæ‹“å±•ä¸€ä¸‹çŸ¥è¯†é¢ã€‚

**èŒ´å­—æœ‰å››ç§å†™æ³•ï¼Œ233333...ï¼Œ æ–‡æœ«æœ‰å½©è›‹æœ‰æƒŠå–œã€‚**

### 1ã€ç®€çŸ­ä¼˜é›…åœ°å®ç° sleep å‡½æ•°

å¾ˆå¤šè¯­è¨€éƒ½æœ‰ `sleep` å‡½æ•°ï¼Œæ˜¾ç„¶ `js` æ²¡æœ‰ï¼Œé‚£ä¹ˆå¦‚ä½•èƒ½ç®€çŸ­ä¼˜é›…åœ°å®ç°è¿™ä¸ªæ–¹æ³•ï¼Ÿ

#### 1.1 æ™®é€šç‰ˆ

```javascript
function sleep(sleepTime) {
	for(var start = +new Dat e; +new Date - start <= sleepTime;) {}
}
var t1 = +new Date()
sleep(3000)
var t2 = +new Date()
console.log(t2 - t1)
```

ä¼˜ç‚¹ï¼šç®€å•ç²—æš´ï¼Œé€šä¿—æ˜“æ‡‚ã€‚
ç¼ºç‚¹ï¼šè¿™æ˜¯æœ€ç®€å•ç²—æš´çš„å®ç°ï¼Œç¡®å® sleep äº†ï¼Œä¹Ÿç¡®å®å¡æ­»äº†ï¼ŒCPU ä¼šé£™å‡ï¼Œæ— è®ºä½ çš„æœåŠ¡å™¨ CPU æœ‰å¤šä¹ˆ Niubilityã€‚

#### 1.2 Promise ç‰ˆæœ¬

```javascript
function sleep(time) {
  return new Promise(resolve => setTimeout(resolve, time))
}

const t1 = +new Date()
sleep(3000).then(() => {
  const t2 = +new Date()
  console.log(t2 - t1)
})
```

ä¼˜ç‚¹ï¼šè¿™ç§æ–¹å¼å®é™…ä¸Šæ˜¯ç”¨äº† `setTimeout`ï¼Œæ²¡æœ‰å½¢æˆè¿›ç¨‹é˜»å¡ï¼Œä¸ä¼šé€ æˆæ€§èƒ½å’Œè´Ÿè½½é—®é¢˜ã€‚
ç¼ºç‚¹ï¼šè™½ç„¶ä¸åƒ `callback `å¥—é‚£ä¹ˆå¤šå±‚ï¼Œä½†ä»ä¸æ€ä¹ˆç¾è§‚ï¼Œè€Œä¸”å½“æˆ‘ä»¬éœ€è¦åœ¨æŸè¿‡ç¨‹ä¸­éœ€è¦åœæ­¢æ‰§è¡Œï¼ˆæˆ–è€…åœ¨ä¸­é€”è¿”å›äº†é”™è¯¯çš„å€¼ï¼‰ï¼Œè¿˜å¿…é¡»å¾—å±‚å±‚åˆ¤æ–­åè·³å‡ºï¼Œéå¸¸éº»çƒ¦ï¼Œè€Œä¸”è¿™ç§å¼‚æ­¥å¹¶ä¸æ˜¯é‚£ä¹ˆå½»åº•ï¼Œè¿˜æ˜¯çœ‹èµ·æ¥åˆ«æ‰­ã€‚

#### 1.3 Generator ç‰ˆæœ¬

```javascript
function sleep(delay) {
  return function(cb) {
    setTimeout(cb.bind(this), delay)
  };
}

function* genSleep() {
  const t1 = +new Date()
  yield sleep(3000)
  const t2 = +new Date()
  console.log(t2 - t1)
}

async(genSleep)

function async(gen) {
  const iter = gen()
  function nextStep(it) {
    if (it.done) return
    if (typeof it.value === "function") {
      it.value(function(ret) {
        nextStep(iter.next(ret))
      })
    } else {
      nextStep(iter.next(it.value))
    }
  }
  nextStep(iter.next())
}
```

ä¼˜ç‚¹ï¼šåŒ `Promise` ä¼˜ç‚¹ï¼Œå¦å¤–ä»£ç å°±å˜å¾—éå¸¸ç®€å•å¹²å‡€ï¼Œæ²¡æœ‰ then é‚£ä¹ˆç”Ÿç¡¬å’Œæ¶å¿ƒã€‚
ç¼ºç‚¹ï¼šä½†ä¸è¶³ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯æ¯æ¬¡éƒ½è¦æ‰§è¡Œ next() æ˜¾å¾—å¾ˆéº»çƒ¦ï¼Œè™½ç„¶æœ‰ [**co**](https://github.com/tj/co)ï¼ˆç¬¬ä¸‰æ–¹åŒ…ï¼‰å¯ä»¥è§£å†³ï¼Œä½†å°±å¤šåŒ…äº†ä¸€å±‚ï¼Œä¸å¥½çœ‹ï¼Œé”™è¯¯ä¹Ÿå¿…é¡»æŒ‰ [**co**](https://github.com/tj/co) çš„é€»è¾‘æ¥å¤„ç†ï¼Œä¸çˆ½ã€‚

**co ä¹‹æ‰€ä»¥è¿™ä¹ˆç«å¹¶ä¸æ˜¯æ²¡æœ‰åŸå› çš„ï¼Œå½“ç„¶ä¸æ˜¯ä»…ä»…å®ç°`` sleep `è¿™ä¹ˆæ— èŠçš„äº‹æƒ…ï¼Œè€Œæ˜¯å®ƒæ´»ç”Ÿç”Ÿçš„å€Ÿç€generator/yield å®ç°äº†å¾ˆç±»ä¼¼ `async/await `çš„æ•ˆæœï¼è¿™ä¸€ç‚¹çœŸæ˜¯è®©æˆ‘ä¸‰è§‚å°½æ¯åˆ®ç›®ç›¸çœ‹ã€‚**

```javascript
const co = require("co")
function sleep(delay) {
  return function(cb) {
    setTimeout(cb.bind(this), delay)
  }
}

co(function*() {
  const t1 = +new Date()
  yield sleep(3000)
  const t2 = +new Date()
  console.log(t2 - t1)
})
```

#### 1.4 Async/Await ç‰ˆæœ¬

```javascript
function sleep(delay) {
  return new Promise(reslove => {
    setTimeout(reslove, delay)
  })
}

!async function test() {
  const t1 = +new Date()
  await sleep(3000)
  const t2 = +new Date()
  console.log(t2 - t1)
}()
```

ä¼˜ç‚¹ï¼šåŒ Promise å’Œ Generator ä¼˜ç‚¹ã€‚ Async/Await å¯ä»¥çœ‹åšæ˜¯ Generator çš„è¯­æ³•ç³–ï¼ŒAsync å’Œ Await ç›¸è¾ƒäº * å’Œ yield æ›´åŠ è¯­ä¹‰ï¼Œå¦å¤–å„ä¸ªå‡½æ•°éƒ½æ˜¯æ‰å¹³çš„ï¼Œä¸ä¼šäº§ç”Ÿå¤šä½™çš„åµŒå¥—ï¼Œä»£ç æ›´åŠ æ¸…çˆ½æ˜“è¯»ã€‚
ç¼ºç‚¹ï¼š ES7 è¯­æ³•å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ï¼Œæœ‰ babel ä¸€åˆ‡å…¼å®¹æ€§éƒ½ä¸æ˜¯é—®é¢˜

è‡³äº `Async/Await` æ¯” `Promise` å’Œ `Generator` çš„å¥½å¤„å¯ä»¥å‚è€ƒè¿™ä¸¤ç¯‡æ–‡ç« ï¼š
[Async/Await æ¯” Generator çš„å››ä¸ªæ”¹è¿›ç‚¹](https://juejin.im/post/59f9ce7a51882554f666220f)
[å…³äºAsync/Awaitæ›¿ä»£Promiseçš„6ä¸ªç†ç”±](https://juejin.im/post/58ede4c1b123db43cc365551)

#### 1.5 ä¸è¦å¿˜äº†å¼€æºçš„åŠ›é‡

**åœ¨ javascript ä¼˜é›…çš„å†™ sleep ç­‰äºå¦‚ä½•ä¼˜é›…çš„ä¸ä¼˜é›…ï¼Œ2333**

> è¿™é‡Œæœ‰ C++ å®ç°çš„æ¨¡å—ï¼š<https://github.com/ErikDubbelboer/node-sleep>

```javascript
const sleep = require("sleep")

const t1 = +new Date()
sleep.msleep(3000)
const t2 = +new Date()
console.log(t2 - t1)
```

ä¼˜ç‚¹ï¼šèƒ½å¤Ÿå®ç°æ›´åŠ ç²¾ç»†çš„æ—¶é—´ç²¾ç¡®åº¦ï¼Œè€Œä¸”çœ‹èµ·æ¥å°±æ˜¯çœŸçš„ sleep å‡½æ•°ï¼Œæ¸…æ™°ç›´ç™½ã€‚
ç¼ºç‚¹ï¼šç¼ºç‚¹éœ€è¦å®‰è£…è¿™ä¸ªæ¨¡å—ï¼Œ`^_^`ï¼Œè¿™ä¹Ÿè®¸ç®—ä¸ä¸Šä»€ä¹ˆç¼ºç‚¹ã€‚

**ä»ä¸€ä¸ªé—´ç®€ç®€å•å•çš„ sleep å‡½æ•°æˆ‘ä»¬å°±å°±å¯ä»¥ç®¡ä¸­çª¥è±¹ï¼Œçœ‹è§ JavaScript è¿‘å‡ å¹´æ¥ä¸æ–­å¿«é€Ÿçš„å‘å±•ï¼Œä¸å•å•æ˜¯å¼‚æ­¥ç¼–ç¨‹è¿™ä¸€å—ï¼Œè¿˜æœ‰å„ç§å„æ ·çš„æ–°æŠ€æœ¯å’Œæ–°æ¡†æ¶ï¼Œè§è¯äº† JavaScript çš„ç¹è£ã€‚**

**ä½ å¯èƒ½ä¸çŸ¥é“çš„å‰ç«¯çŸ¥è¯†ç‚¹ï¼šAsync/Awaitæ˜¯ç›®å‰å‰ç«¯å¼‚æ­¥ä¹¦å†™æœ€ä¼˜é›…çš„ä¸€ç§æ–¹å¼**

### 2ã€è·å–æ—¶é—´æˆ³

ä¸Šé¢ç¬¬ä¸€ä¸ªç”¨å¤šç§æ–¹å¼å®ç° `sleep` å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ä»£ç æœ‰ `+new Date()`è·å–æ—¶é—´æˆ³çš„ç”¨æ³•ï¼Œè¿™åªæ˜¯å…¶ä¸­çš„ä¸€ç§ï¼Œä¸‹é¢å°±è¯´ä¸€ä¸‹å…¶ä»–ä¸¤ç§ä»¥åŠ `+new Date()`çš„åŸç†ã€‚

#### 2.1 æ™®é€šç‰ˆ

```javascript
var timestamp=new Date().getTime()
```

ä¼˜ç‚¹ï¼šå…·æœ‰æ™®éæ€§ï¼Œå¤§å®¶éƒ½ç”¨è¿™ä¸ª
ç¼ºç‚¹ï¼šç›®å‰æ²¡æœ‰å‘ç°

#### 2.2 è¿›é˜¶ç‰ˆ

```javascript
var timestamp = (new Date()).valueOf()
```

> valueOf æ–¹æ³•è¿”å›å¯¹è±¡çš„åŸå§‹å€¼(Primitive,'Null','Undefined','String','Boolean','Number'äº”ç§åŸºæœ¬æ•°æ®ç±»å‹ä¹‹ä¸€)ï¼Œå¯èƒ½æ˜¯å­—ç¬¦ä¸²ã€æ•°å€¼æˆ– bool å€¼ç­‰ï¼Œçœ‹å…·ä½“çš„å¯¹è±¡ã€‚

ä¼˜ç‚¹ï¼šè¯´æ˜å¼€å‘è€…åŸå§‹å€¼æœ‰ä¸€ä¸ªå…·ä½“çš„è®¤çŸ¥ï¼Œè®©äººçœ¼å‰ä¸€äº®ã€‚
ç¼ºç‚¹: ç›®å‰æ²¡æœ‰å‘ç°

#### 2.3 ç»ˆæç‰ˆ

```javascript
var timestamp = +new Date()
```

ä¼˜ç‚¹ï¼šå¯¹ JavaScript éšå¼è½¬æ¢æŒæ¡çš„æ¯”è¾ƒç‰¢å›ºçš„ä¸€ä¸ªè¡¨ç°
ç¼ºç‚¹ï¼šç›®å‰æ²¡æœ‰å‘ç°

ç°åœ¨å°±ç®€å•åˆ†æä¸€ä¸‹ä¸ºä»€ä¹ˆ `+new Date()` æ‹¿åˆ°çš„æ˜¯æ—¶é—´æˆ³ã€‚

**ä¸€è¨€ä»¥è”½ä¹‹ï¼Œè¿™æ˜¯éšå¼è½¬æ¢çš„ç„å­¦ï¼Œå®è´¨è¿˜æ˜¯è°ƒç”¨äº† valueOf() çš„æ–¹æ³•ã€‚**

æˆ‘ä»¬å…ˆçœ‹çœ‹ `ECMAScript` è§„èŒƒå¯¹ä¸€å…ƒè¿ç®—ç¬¦çš„è§„èŒƒï¼š

**ä¸€å…ƒ+ è¿ç®—ç¬¦**

ä¸€å…ƒ `+` è¿ç®—ç¬¦å°†å…¶æ“ä½œæ•°è½¬æ¢ä¸º `Number` ç±»å‹å¹¶åè½¬å…¶æ­£è´Ÿã€‚æ³¨æ„è´Ÿçš„ `+0` äº§ç”Ÿ `-0`ï¼Œè´Ÿçš„ `-0` äº§ç”Ÿ `+0`ã€‚äº§ç”Ÿå¼ `UnaryExpression : - UnaryExpression` æŒ‰ç…§ä¸‹é¢çš„è¿‡ç¨‹æ‰§è¡Œã€‚

> 1. ä»¤ expr ä¸ºè§£é‡Šæ‰§è¡Œ UnaryExpression çš„ç»“æœ .
> 2. ä»¤ oldValue ä¸º ToNumber(GetValue(expr)).
> 3. å¦‚æœ oldValue is NaN ï¼Œreturn NaN.
> 4. è¿”å› oldValue å–è´Ÿï¼ˆå³ï¼Œç®—å‡ºä¸€ä¸ªæ•°å­—ç›¸åŒä½†æ˜¯ç¬¦å·ç›¸åçš„å€¼ï¼‰çš„ç»“æœã€‚

**``+new Date()`` ç›¸å½“äº`` ToNumber(new Date())``**

æˆ‘ä»¬å†æ¥çœ‹çœ‹ `ECMAScript` è§„èŒƒå¯¹ `ToNumber` çš„å®šä¹‰ï¼š

[![img](https://camo.githubusercontent.com/496f833832f11f2260af76c7048bbef32b8c31dd/68747470733a2f2f706963342e7a68696d672e636f6d2f35302f76322d31336664393733303963383439653039396466303139363366383565323931335f68642e6a7067)](https://camo.githubusercontent.com/496f833832f11f2260af76c7048bbef32b8c31dd/68747470733a2f2f706963342e7a68696d672e636f6d2f35302f76322d31336664393733303963383439653039396466303139363366383565323931335f68642e6a7067)

æˆ‘ä»¬çŸ¥é“ `new Date()` æ˜¯ä¸ªå¯¹è±¡ï¼Œæ»¡è¶³ä¸Šé¢çš„ `ToPrimitive()`ï¼Œæ‰€ä»¥è¿›è€Œæˆäº† `ToPrimitive(new Date())`ã€‚

æ¥ç€æˆ‘ä»¬å†æ¥çœ‹çœ‹ `ECMAScript` è§„èŒƒå¯¹ `ToPrimitive` çš„å®šä¹‰ï¼Œä¸€å±‚ä¸€å±‚æ¥ï¼ŒæŠ½ä¸å‰¥èŒ§ã€‚

[![img](https://camo.githubusercontent.com/a9fbade449ef107129c103917c4af444717dbfd7/68747470733a2f2f706963342e7a68696d672e636f6d2f35302f76322d32396334376363623638323838336438623433616239663937303936623563335f68642e6a7067)](https://camo.githubusercontent.com/a9fbade449ef107129c103917c4af444717dbfd7/68747470733a2f2f706963342e7a68696d672e636f6d2f35302f76322d32396334376363623638323838336438623433616239663937303936623563335f68642e6a7067)

è¿™ä¸ª `ToPrimitive` åˆšå¼€å§‹å¯èƒ½ä¸å¤ªå¥½æ‡‚ï¼Œæˆ‘æ¥å¤§è‡´è§£é‡Šä¸€ä¸‹å§ï¼š

**ToPrimitive(obj,preferredType)**

`JavaScript` å¼•æ“å†…éƒ¨è½¬æ¢ä¸ºåŸå§‹å€¼ `ToPrimitive(obj,preferredType)` å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ª `obj` ä¸ºè¢«è½¬æ¢çš„å¯¹è±¡ï¼Œç¬¬äºŒä¸ª`preferredType` ä¸ºå¸Œæœ›è½¬æ¢æˆçš„ç±»å‹ï¼ˆé»˜è®¤ä¸ºç©ºï¼Œæ¥å—çš„å€¼ä¸º `Number` æˆ– `String`ï¼‰

åœ¨æ‰§è¡Œ `ToPrimitive(obj,preferredType)` æ—¶å¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸ºç©ºå¹¶ä¸” `obj` ä¸º `Date` çš„å®ä¾‹æ—¶ï¼Œæ­¤æ—¶ `preferredType` ä¼šè¢«è®¾ç½®ä¸º `String`ï¼Œå…¶ä»–æƒ…å†µä¸‹ `preferredType` éƒ½ä¼šè¢«è®¾ç½®ä¸º`Number` å¦‚æœ `preferredType`ä¸º `Number`ï¼Œ`ToPrimitive` æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š

> 1. å¦‚æœobjä¸ºåŸå§‹å€¼ï¼Œç›´æ¥è¿”å›ï¼›
> 2. å¦åˆ™è°ƒç”¨ obj.valueOf()ï¼Œå¦‚æœæ‰§è¡Œç»“æœæ˜¯åŸå§‹å€¼ï¼Œè¿”å›ä¹‹ï¼›
> 3. å¦åˆ™è°ƒç”¨ obj.toString()ï¼Œå¦‚æœæ‰§è¡Œç»“æœæ˜¯åŸå§‹å€¼ï¼Œè¿”å›ä¹‹ï¼›
> 4. å¦åˆ™æŠ›å¼‚å¸¸ã€‚

å¦‚æœ `preferredType` ä¸º `String`ï¼Œå°†ä¸Šé¢çš„ç¬¬2æ­¥å’Œç¬¬3æ­¥è°ƒæ¢ï¼Œå³ï¼š

> 1. å¦‚æœobjä¸ºåŸå§‹å€¼ï¼Œç›´æ¥è¿”å›ï¼›
> 2. å¦åˆ™è°ƒç”¨ obj.toString()ï¼Œå¦‚æœæ‰§è¡Œç»“æœæ˜¯åŸå§‹å€¼ï¼Œè¿”å›ä¹‹ï¼›
> 3. å¦åˆ™è°ƒç”¨ obj.valueOf()ï¼Œå¦‚æœæ‰§è¡Œç»“æœæ˜¯åŸå§‹å€¼ï¼Œè¿”å›ä¹‹ï¼›
> 4. å¦åˆ™æŠ›å¼‚å¸¸ã€‚

é¦–å…ˆæˆ‘ä»¬è¦æ˜ç™½ `obj.valueOf()` å’Œ `obj.toString()` è¿˜æœ‰åŸå§‹å€¼åˆ†åˆ«æ˜¯ä»€ä¹ˆæ„æ€,è¿™æ˜¯å¼„æ‡‚ä¸Šé¢æè¿°çš„å‰æä¹‹ä¸€:

**toString ç”¨æ¥è¿”å›å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚**

```javascript
var obj = {};
console.log(obj.toString());//[object Object]

var arr2 = [];
console.log(arr2.toString());//""ç©ºå­—ç¬¦ä¸²

var date = new Date();
console.log(date.toString());//Sun Feb 28 2016 13:40:36 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)
```

**valueOf æ–¹æ³•è¿”å›å¯¹è±¡çš„åŸå§‹å€¼ï¼Œå¯èƒ½æ˜¯å­—ç¬¦ä¸²ã€æ•°å€¼æˆ– bool å€¼ç­‰ï¼Œçœ‹å…·ä½“çš„å¯¹è±¡ã€‚**

```javascript
var obj = {
  name: "obj"
}
console.log(obj.valueOf()) //Object {name: "obj"}

var arr1 = [1]
console.log(arr1.valueOf()) //[1]

var date = new Date()
console.log(date.valueOf())//1456638436303
å¦‚ä»£ç æ‰€ç¤ºï¼Œä¸‰ä¸ªä¸åŒçš„å¯¹è±¡å®ä¾‹è°ƒç”¨valueOfè¿”å›ä¸åŒçš„æ•°æ®
```

**åŸå§‹å€¼æŒ‡çš„æ˜¯ 'Null','Undefined','String','Boolean','Number','Symbol' 6ç§åŸºæœ¬æ•°æ®ç±»å‹ä¹‹ä¸€ï¼Œä¸Šé¢å·²ç»æåˆ°è¿‡è¿™ä¸ªæ¦‚å¿µï¼Œè¿™é‡Œå†æ¬¡ç”³æ˜ä¸€ä¸‹ã€‚**

æœ€ååˆ†è§£ä¸€ä¸‹å…¶ä¸­çš„è¿‡ç¨‹ï¼š`+new Date():`

> 1. è¿ç®—ç¬¦ `new` çš„ä¼˜å…ˆçº§é«˜äºä¸€å…ƒè¿ç®—ç¬¦ `+`ï¼Œæ‰€ä»¥è¿‡ç¨‹å¯ä»¥åˆ†è§£ä¸ºï¼š
>    var time=new Date();
>    +time
> 2. æ ¹æ®ä¸Šé¢æåˆ°çš„è§„åˆ™ç›¸å½“äºï¼š`ToNumber(time)`
> 3. `time` æ˜¯ä¸ªæ—¥æœŸå¯¹è±¡ï¼Œæ ¹æ® `ToNumber` çš„è½¬æ¢è§„åˆ™ï¼Œæ‰€ä»¥ç›¸å½“äºï¼š`ToNumber(ToPrimitive(time))`
> 4. æ ¹æ® `ToPrimitive` çš„è½¬æ¢è§„åˆ™ï¼š`ToNumber(time.valueOf())`ï¼Œ`time.valueOf()` å°±æ˜¯ åŸå§‹å€¼ å¾—åˆ°çš„æ˜¯ä¸ªæ—¶é—´æˆ³ï¼Œå‡è®¾ `time.valueOf()=1503479124652`
> 5. æ‰€ä»¥ `ToNumber(1503479124652)` è¿”å›å€¼æ˜¯ `1503479124652` è¿™ä¸ªæ•°å­—ã€‚
> 6. åˆ†æå®Œæ¯•

**ä½ å¯èƒ½ä¸çŸ¥é“çš„å‰ç«¯çŸ¥è¯†ç‚¹ï¼šéšå¼è½¬æ¢çš„å¦™ç”¨**

### 3ã€æ•°ç»„å»é‡

æ³¨ï¼šæš‚ä¸è€ƒè™‘`å¯¹è±¡å­—é¢`é‡ï¼Œ`å‡½æ•°`ç­‰å¼•ç”¨ç±»å‹çš„å»é‡ï¼Œä¹Ÿä¸è€ƒè™‘ `NaN`, `undefined`, `null`ç­‰ç‰¹æ®Šç±»å‹æƒ…å†µã€‚

> æ•°ç»„æ ·æœ¬ï¼š[1, 1, '1', '2', 1]

#### 3.1 æ™®é€šç‰ˆ

`æ— éœ€æ€è€ƒï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ° O(n^2) å¤æ‚åº¦çš„è§£æ³•ã€‚å®šä¹‰ä¸€ä¸ªå˜é‡æ•°ç»„ res ä¿å­˜ç»“æœï¼Œéå†éœ€è¦å»é‡çš„æ•°ç»„ï¼Œå¦‚æœè¯¥å…ƒç´ å·²ç»å­˜åœ¨åœ¨ res ä¸­äº†ï¼Œåˆ™è¯´æ˜æ˜¯é‡å¤çš„å…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™æ”¾å…¥ res ä¸­ã€‚`

```javascript
var a = [1, 1, '1', '2', 1]
function unique(arr) {
    var res = []
    for (var i = 0, len = arr.length; i < len; i++) {
        var item = arr[i]
        for (var j = 0, len = res.length; j < jlen; j++) {
            if (item === res[j]) //arræ•°ç»„çš„itemåœ¨reså·²ç»å­˜åœ¨,å°±è·³å‡ºå¾ªç¯
                break
        }
        if (j === jlen) //å¾ªç¯å®Œæ¯•,arræ•°ç»„çš„itemåœ¨resæ‰¾ä¸åˆ°,å°±pushåˆ°resæ•°ç»„ä¸­
            res.push(item)
    }
    return res
}
console.log(unique(a)) // [1, 2, "1"]
```

ä¼˜ç‚¹ï¼š æ²¡æœ‰ä»»ä½•å…¼å®¹æ€§é—®é¢˜ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œæ²¡æœ‰ä»»ä½•ç†è§£æˆæœ¬
ç¼ºç‚¹ï¼š çœ‹èµ·æ¥æ¯”è¾ƒè‡ƒè‚¿æ¯”è¾ƒç¹çï¼Œæ—¶é—´å¤æ‚åº¦æ¯”è¾ƒé«˜`O(n^2)`

#### 3.2 è¿›é˜¶ç‰ˆ

```javascript
var a =  [1, 1, '1', '2', 1]
function unique(arr) {
    return arr.filter(function(ele,index,array){
        return array.indexOf(ele) === index//å¾ˆå·§å¦™,è¿™æ ·ç­›é€‰ä¸€å¯¹ä¸€çš„,è¿‡æ»¤æ‰é‡å¤çš„
    })
}
console.log(unique(a)) // [1, 2, "1"]
```

ä¼˜ç‚¹ï¼šå¾ˆç®€æ´ï¼Œæ€ç»´ä¹Ÿæ¯”è¾ƒå·§å¦™ï¼Œç›´è§‚æ˜“æ‡‚ã€‚
ç¼ºç‚¹ï¼šä¸æ”¯æŒ `IE9` ä»¥ä¸‹çš„æµè§ˆå™¨ï¼Œæ—¶é—´å¤æ‚åº¦è¿˜æ˜¯`O(n^2)`

#### 3.3 æ—¶é—´å¤æ‚åº¦ä¸ºO(n)

```javascript
var a =  [1, 1, '1', '2', 1]
function unique(arr) {
    var obj = {}
    return arr.filter(function(item, index, array){
        return obj.hasOwnProperty(typeof item + item) ? 
        false : 
        (obj[typeof item + item] = true)
    })
}

console.log(unique(a)) // [1, 2, "1"]
```

ä¼˜ç‚¹ï¼š`hasOwnProperty` æ˜¯å¯¹è±¡çš„å±æ€§(åç§°)å­˜åœ¨æ€§æ£€æŸ¥æ–¹æ³•ã€‚å¯¹è±¡çš„å±æ€§å¯ä»¥åŸºäº `Hash` è¡¨å®ç°ï¼Œå› æ­¤å¯¹å±æ€§è¿›è¡Œè®¿é—®çš„æ—¶é—´å¤æ‚åº¦å¯ä»¥è¾¾åˆ°`O(1)`;
`filter` æ˜¯æ•°ç»„è¿­ä»£çš„æ–¹æ³•ï¼Œå†…éƒ¨è¿˜æ˜¯ä¸€ä¸ª `for` å¾ªç¯ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯ `O(n)`ã€‚
ç¼ºç‚¹ï¼šä¸å…¼å®¹ `IE9` ä»¥ä¸‹æµè§ˆå™¨ï¼Œå…¶å®ä¹Ÿå¥½è§£å†³ï¼ŒæŠŠ `filter` æ–¹æ³•ç”¨ `for` å¾ªç¯ä»£æ›¿æˆ–è€…è‡ªå·±æ¨¡æ‹Ÿä¸€ä¸ª filter æ–¹æ³•ã€‚

#### 3.4 ç»ˆæç‰ˆ

> ä»¥ Set ä¸ºä¾‹ï¼ŒES6 æä¾›äº†æ–°çš„æ•°æ®ç»“æ„ Setã€‚å®ƒç±»ä¼¼äºæ•°ç»„ï¼Œä½†æ˜¯æˆå‘˜çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œæ²¡æœ‰é‡å¤çš„å€¼ã€‚

```javascript
const unique = a => [...new Set(a)]
```

ä¼˜ç‚¹ï¼š`ES6` è¯­æ³•ï¼Œç®€æ´é«˜æ•ˆï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå»é‡æ–¹æ³•ä»åŸå§‹çš„ `14` è¡Œä»£ç åˆ° `ES6` çš„ `1` è¡Œä»£ç ï¼Œå…¶å®ä¹Ÿè¯´æ˜äº† `JavaScript` è¿™é—¨è¯­è¨€åœ¨ä¸åœçš„è¿›æ­¥ï¼Œç›¸ä¿¡ä»¥åçš„å¼€å‘ä¹Ÿä¼šè¶Šæ¥è¶Šé«˜æ•ˆã€‚
ç¼ºç‚¹ï¼šå…¼å®¹æ€§é—®é¢˜ï¼Œç°ä»£æµè§ˆå™¨æ‰æ”¯æŒï¼Œæœ‰ `babel` è¿™äº›éƒ½ä¸æ˜¯é—®é¢˜ã€‚

**ä½ å¯èƒ½ä¸çŸ¥é“çš„å‰ç«¯çŸ¥è¯†ç‚¹ï¼šES6 æ–°çš„æ•°æ®ç»“æ„ Set å»é‡**

### 4ã€æ•°å­—æ ¼å¼åŒ– 1234567890 --> 1,234,567,890

#### 4.1 æ™®é€šç‰ˆ

```javascript
function formatNumber(str) {
  let arr = [],
    count = str.length

  while (count >= 3) {
    arr.unshift(str.slice(count - 3, count))
    count -= 3
  }

  // å¦‚æœæ˜¯ä¸æ˜¯3çš„å€æ•°å°±å¦å¤–è¿½åŠ åˆ°ä¸Šå»
  str.length % 3 && arr.unshift(str.slice(0, str.length % 3))

  return arr.toString()

}
console.log(formatNumber("1234567890")) // 1,234,567,890
```

ä¼˜ç‚¹ï¼šè‡ªæˆ‘æ„Ÿè§‰æ¯”ç½‘ä¸Šå†™çš„ä¸€å † forå¾ªç¯ è¿˜æœ‰ if-else åˆ¤æ–­çš„é€»è¾‘æ›´åŠ æ¸…æ™°ç›´ç™½ã€‚
ç¼ºç‚¹ï¼šå¤ªæ™®é€š

#### 4.2 è¿›é˜¶ç‰ˆ

```
function formatNumber(str) {

  // ["0", "9", "8", "7", "6", "5", "4", "3", "2", "1"]
  return str.split("").reverse().reduce((prev, next, index) => {
    return ((index % 3) ? next : (next + ',')) + prev
  })
}

console.log(formatNumber("1234567890")) // 1,234,567,890
```

ä¼˜ç‚¹ï¼šæŠŠ JS çš„ API ç©çš„äº†å¦‚æŒ‡æŒ
ç¼ºç‚¹ï¼šå¯èƒ½æ²¡é‚£ä¹ˆå¥½æ‡‚ï¼Œä¸è¿‡è¯»æ‡‚ä¹‹åå°±ä¼šå‘å‡ºæˆ‘æ€ä¹ˆæ²¡æƒ³åˆ°çš„æ„Ÿè§‰

#### 4.3 æ­£åˆ™ç‰ˆ

```
function formatNumber(str) {
  return str.replace(/\B(?=(\d{3})+(?!\d))/g, ',')
}

console.log(formatNumber("123456789")) // 1,234,567,890
```

ä¸‹é¢ç®€å•åˆ†æä¸‹æ­£åˆ™`/\B(?=(\d{3})+(?!\d))/g`ï¼š

> 1. `/\B(?=(\d{3})+(?!\d))/g`ï¼šæ­£åˆ™åŒ¹é…è¾¹ç•Œ`\B`ï¼Œè¾¹ç•Œåé¢å¿…é¡»è·Ÿç€`(\d{3})+(?!\d)`;
> 2. `(\d{3})+`ï¼šå¿…é¡»æ˜¯1ä¸ªæˆ–å¤šä¸ªçš„3ä¸ªè¿ç»­æ•°å­—;
> 3. `(?!\d)`ï¼šç¬¬2æ­¥ä¸­çš„3ä¸ªæ•°å­—ä¸å…è®¸åé¢è·Ÿç€æ•°å­—;
> 4. `(\d{3})+(?!\d)`ï¼šæ‰€ä»¥åŒ¹é…çš„è¾¹ç•Œåé¢å¿…é¡»è·Ÿç€`3*n`ï¼ˆn>=1ï¼‰çš„æ•°å­—ã€‚

æœ€ç»ˆæŠŠåŒ¹é…åˆ°çš„æ‰€æœ‰è¾¹ç•Œæ¢æˆ`,`å³å¯è¾¾æˆç›®æ ‡ã€‚

ä¼˜ç‚¹ï¼šä»£ç å°‘ï¼Œæµ“ç¼©çš„å°±æ˜¯ç²¾å
ç¼ºç‚¹ï¼šéœ€è¦å¯¹æ­£åˆ™è¡¨è¾¾å¼çš„ä½ç½®åŒ¹é…æœ‰ä¸€ä¸ªè¾ƒæ·±çš„è®¤è¯†ï¼Œé—¨æ§›å¤§ä¸€ç‚¹

#### 4.4 APIç‰ˆ

```
(123456789).toLocaleString('en-US')  // 1,234,567,890
```

å¦‚å›¾ï¼Œä½ å¯èƒ½è¿˜ä¸çŸ¥é“ `JavaScript` çš„ `toLocaleString` è¿˜å¯ä»¥è¿™ä¹ˆç©ã€‚

[![img](https://camo.githubusercontent.com/f2d3615a7c5c5c736a32f87cf21639551f86e882/68747470733a2f2f7773342e73696e61696d672e636e2f6c617267652f303036744e625277677931666d717434646f6d65346a3330783630636137376d2e6a7067)](https://camo.githubusercontent.com/f2d3615a7c5c5c736a32f87cf21639551f86e882/68747470733a2f2f7773342e73696e61696d672e636e2f6c617267652f303036744e625277677931666d717434646f6d65346a3330783630636137376d2e6a7067)

**è¿˜å¯ä»¥ä½¿ç”¨** [Intlå¯¹è±¡ - MDN](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Intl)

> Intl å¯¹è±¡æ˜¯ ECMAScript å›½é™…åŒ– API çš„ä¸€ä¸ªå‘½åç©ºé—´ï¼Œå®ƒæä¾›äº†ç²¾ç¡®çš„å­—ç¬¦ä¸²å¯¹æ¯”ï¼Œæ•°å­—æ ¼å¼åŒ–ï¼Œæ—¥æœŸå’Œæ—¶é—´æ ¼å¼åŒ–ã€‚Collatorï¼ŒNumberFormat å’Œ DateTimeFormat å¯¹è±¡çš„æ„é€ å‡½æ•°æ˜¯ Intl å¯¹è±¡çš„å±æ€§ã€‚

```
new Intl.NumberFormat().format(1234567890) // 1,234,567,890
```

ä¼˜ç‚¹ï¼šç®€å•ç²—æš´ï¼Œç›´æ¥è°ƒç”¨ API
ç¼ºç‚¹ï¼š[Intlå…¼å®¹æ€§](https://caniuse.com/#search=Intl)ä¸å¤ªå¥½ï¼Œä¸è¿‡ toLocaleStringçš„è¯ IE6 éƒ½æ”¯æŒ

**ä½ å¯èƒ½ä¸çŸ¥é“çš„å‰ç«¯çŸ¥è¯†ç‚¹ï¼šIntlå¯¹è±¡ å’Œ toLocaleStringçš„æ–¹æ³•ã€‚**

### 5ã€äº¤æ¢ä¸¤ä¸ªæ•´æ•°

let a = 3,b = 4 å˜æˆ a = 4, b = 3

#### 5.1 æ™®é€šç‰ˆ

é¦–å…ˆæœ€å¸¸è§„çš„åŠæ³•ï¼Œå¼•å…¥ä¸€ä¸ª temp ä¸­é—´å˜é‡

```
let a = 3,b = 4
let temp = a
a = b
b = temp
console.log(a, b)
```

ä¼˜ç‚¹ï¼šä¸€çœ¼èƒ½çœ‹æ‡‚å°±æ˜¯æœ€å¥½çš„ä¼˜ç‚¹
ç¼ºç‚¹ï¼šç¡¬è¯´ç¼ºç‚¹å°±æ˜¯å¼•å…¥äº†ä¸€ä¸ªå¤šä½™çš„å˜é‡

#### 5.2 è¿›é˜¶ç‰ˆ

åœ¨ä¸å¼•å…¥ä¸­é—´å˜é‡çš„æƒ…å†µä¸‹ä¹Ÿèƒ½äº¤äº’ä¸¤ä¸ªå˜é‡

```
let a = 3,b = 4
a += b
b = a - b
a -= b
console.log(a, b)
```

ä¼˜ç‚¹ï¼šæ¯”èµ·æ¥¼ä¸Šé‚£ç§æ²¡æœ‰å¼•å…¥å¤šä½™çš„å˜é‡ï¼Œæ¯”ä¸Šé¢é‚£ä¸€ç§ç¨å¾®å·§å¦™ä¸€ç‚¹
ç¼ºç‚¹ï¼šå½“ç„¶ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œæ•´å‹æ•°æ®æº¢å‡ºï¼Œæ¯”å¦‚è¯´å¯¹äº32ä½å­—ç¬¦æœ€å¤§è¡¨ç¤ºæœ‰ç¬¦å·æ•°å­—æ˜¯2147483647ï¼Œä¹Ÿå°±æ˜¯Math.pow(2,31)-1ï¼Œå¦‚æœæ˜¯2147483645å’Œ2147483646äº¤æ¢å°±å¤±è´¥äº†ã€‚

#### 5.3 ç»ˆæç‰ˆ

åˆ©ç”¨ä¸€ä¸ªæ•°å¼‚æˆ–æœ¬èº«ç­‰äºï¼å’Œå¼‚æˆ–è¿ç®—ç¬¦åˆäº¤æ¢ç‡ã€‚

```
let a = 3,b = 4
  a ^= b
  b ^= a
  a ^= b
console.log(a, b)
```

ä¸‹é¢ç”¨ç«–å¼è¿›è¡Œç®€å•è¯´æ˜ï¼š(10è¿›åˆ¶åŒ–ä¸ºäºŒè¿›åˆ¶)

```
    a = 011
(^) b = 100
åˆ™  a = 111(a ^ bçš„ç»“æœèµ‹å€¼ç»™aï¼Œaå·²å˜æˆäº†7)
(^) b = 100
åˆ™  b = 011(b^açš„ç»“æœèµ‹ç»™bï¼Œbå·²ç»å˜æˆäº†3)
(^) a = 111
åˆ™  a = 100(a^bçš„ç»“æœèµ‹ç»™aï¼Œaå·²ç»å˜æˆäº†4)

```

ä»ä¸Šé¢çš„ç«–å¼å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°åˆ©ç”¨å¼‚æˆ–è¿ç®—å®ç°ä¸¤ä¸ªå€¼äº¤æ¢çš„åŸºæœ¬è¿‡ç¨‹ã€‚

ä¸‹é¢ä»æ·±å±‚æ¬¡å‰–æä¸€ä¸‹ï¼š

> 1.å¯¹äºå¼€å§‹çš„ä¸¤ä¸ªèµ‹å€¼è¯­å¥ï¼Œa = a ^ bï¼Œb = b ^ aï¼Œç›¸å½“äºb = b ^ (a ^ b) = a ^ b ^ bï¼Œè€Œb ^ b æ˜¾ç„¶ç­‰äº0ã€‚å› æ­¤b = a ^ 0ï¼Œæ˜¾ç„¶ç»“æœä¸ºaã€‚
> \2. åŒç†å¯ä»¥åˆ†æç¬¬ä¸‰ä¸ªèµ‹å€¼è¯­å¥ï¼Œa = a ^ b = (a ^ b) ^ a = b

æ³¨ï¼š

1. ^ å³â€å¼‚æˆ–â€œè¿ç®—ç¬¦ã€‚

> å®ƒçš„æ„æ€æ˜¯åˆ¤æ–­ä¸¤ä¸ªç›¸åº”çš„ä½å€¼æ˜¯å¦ä¸ºâ€å¼‚â€œï¼Œä¸ºâ€å¼‚"(å€¼ä¸åŒ)å°±å–çœŸï¼ˆ1ï¼‰;å¦åˆ™ä¸ºå‡ï¼ˆ0ï¼‰ã€‚

1. ^ è¿ç®—ç¬¦çš„ç‰¹ç‚¹æ˜¯ä¸0å¼‚æˆ–ï¼Œä¿æŒåŸå€¼ï¼›ä¸æœ¬èº«å¼‚æˆ–ï¼Œç»“æœä¸º0ã€‚

ä¼˜ç‚¹ï¼šä¸å­˜åœ¨å¼•å…¥ä¸­é—´å˜é‡ï¼Œä¸å­˜åœ¨æ•´æ•°æº¢å‡º
ç¼ºç‚¹ï¼šå‰ç«¯å¯¹ä½æ“ä½œè¿™ä¸€å—å¯èƒ½äº†è§£ä¸æ·±ï¼Œä¸å®¹æ˜“ç†è§£

#### 5.4 ç©¶æç‰ˆ

ç†Ÿæ‚‰ `ES6` è¯­æ³•çš„äººå½“ç„¶ä¸ä¼šå¯¹è§£æ„é™Œç”Ÿ

```
var a = 3,b = 4;
[b, a] = [a, b]
```

å…¶ä¸­çš„è§£æ„çš„åŸç†ï¼Œæˆ‘æš‚æ—¶è¿˜æ²¡è¯»è¿‡ ES6çš„è§„èŒƒï¼Œä¸çŸ¥é“å…·ä½“çš„ç»†åˆ™ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥çœ‹çœ‹ `babel` æ˜¯è‡ªå·±ç¼–è¯‘çš„ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºç‚¹é—¨è·¯ã€‚

å“ˆå“ˆï¼Œç®€å•ç²—æš´ï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰æŒ‰ç…§ ES çš„è§„èŒƒï¼Œå…¶å®å¯ä»¥æ‰’ä¸€æ‰’ v8çš„æºç ï¼Œchrome å·²ç»å®ç°è¿™ç§è§£æ„ç”¨æ³•ã€‚

[![img](https://camo.githubusercontent.com/509c92224ea81a8a326a7a2e77189c63644a1c35/68747470733a2f2f7773322e73696e61696d672e636e2f6c617267652f303036744e633739677931666d6c3838376b7171676a3331686f306f7774646f2e6a7067)](https://camo.githubusercontent.com/509c92224ea81a8a326a7a2e77189c63644a1c35/68747470733a2f2f7773322e73696e61696d672e636e2f6c617267652f303036744e633739677931666d6c3838376b7171676a3331686f306f7774646f2e6a7067)

**è¿™ä¸ªä¾‹å­å’Œå‰é¢çš„ä¾‹å­ç¼–å†™é£æ ¼æœ‰ä½•ä¸åŒ**ï¼Œä½ å¦‚æœç»†å¿ƒçš„è¯å°±ä¼šå‘ç°è¿™ä¸¤è¡Œä»£ç å¤šäº†ä¸€ä¸ª**åˆ†å·**ï¼Œå¯¹äºæˆ‘è¿™ç§ç¼–ç ä¸å†™åˆ†å·çš„æ´ç™–è€…ï¼Œä¸ºä»€ä¹ˆåŠ ä¸€ä¸ªåˆ†å·åœ¨è¿™é‡Œï¼Œå…¶å®æ˜¯æœ‰åŸå› çš„ï¼Œè¿™é‡Œå°±ç®€å•æ™®åŠä¸€ä¸‹ï¼Œ**å»ºè®®å¤§å®¶è¿˜æ˜¯å†™ä»£ç å†™ä¸Šåˆ†å·**ã€‚

#### 5.4 ECMAScript è‡ªåŠ¨åˆ†å·;æ’å…¥(ä½œä¸ºè¡¥å……ï¼Œé˜²æ­¢å¤§å®¶ä»¥åè¸©å‘)

å°½ç®¡ JavaScript æœ‰ C çš„ä»£ç é£æ ¼ï¼Œä½†æ˜¯å®ƒä¸å¼ºåˆ¶è¦æ±‚åœ¨ä»£ç ä¸­ä½¿ç”¨åˆ†å·ï¼Œå®é™…ä¸Šå¯ä»¥çœç•¥å®ƒä»¬ã€‚

JavaScript ä¸æ˜¯ä¸€ä¸ªæ²¡æœ‰åˆ†å·çš„è¯­è¨€ï¼Œæ°æ°ç›¸åä¸Šå®ƒéœ€è¦åˆ†å·æ¥å°±è§£ææºä»£ç ã€‚ å› æ­¤ JavaScript è§£æå™¨åœ¨é‡åˆ°ç”±äºç¼ºå°‘åˆ†å·å¯¼è‡´çš„è§£æé”™è¯¯æ—¶ï¼Œä¼šè‡ªåŠ¨åœ¨æºä»£ç ä¸­æ’å…¥åˆ†å·ã€‚

##### 5.4.1ä¾‹å­

```
var foo = function() {
} // è§£æé”™è¯¯ï¼Œåˆ†å·ä¸¢å¤±
test()
```

è‡ªåŠ¨æ’å…¥åˆ†å·ï¼Œè§£æå™¨é‡æ–°è§£æã€‚

```
var foo = function() {
}; // æ²¡æœ‰é”™è¯¯ï¼Œè§£æç»§ç»­
test()
```

##### 5.4.2å·¥ä½œåŸç†

ä¸‹é¢çš„ä»£ç æ²¡æœ‰åˆ†å·ï¼Œå› æ­¤è§£æå™¨éœ€è¦è‡ªå·±åˆ¤æ–­éœ€è¦åœ¨å“ªäº›åœ°æ–¹æ’å…¥åˆ†å·ã€‚

```
(function(window, undefined) {
    function test(options) {
        log('testing!')

        (options.list || []).forEach(function(i) {

        })

        options.value.test(
            'long string to pass here',
            'and another long string to pass'
        )

        return
        {
            foo: function() {}
        }
    }
    window.test = test

})(window)

(function(window) {
    window.someLibrary = {}
})(window)

```

ä¸‹é¢æ˜¯è§£æå™¨"çŒœæµ‹"çš„ç»“æœã€‚

```
(function(window, undefined) {
    function test(options) {

        // æ²¡æœ‰æ’å…¥åˆ†å·ï¼Œä¸¤è¡Œè¢«åˆå¹¶ä¸ºä¸€è¡Œ
        log('testing!')(options.list || []).forEach(function(i) {

        }); // <- æ’å…¥åˆ†å·

        options.value.test(
            'long string to pass here',
            'and another long string to pass'
        ); // <- æ’å…¥åˆ†å·

        return; // <- æ’å…¥åˆ†å·, æ”¹å˜äº† return è¡¨è¾¾å¼çš„è¡Œä¸º
        { // ä½œä¸ºä¸€ä¸ªä»£ç æ®µå¤„ç†
            foo: function() {}
        }; // <- æ’å…¥åˆ†å·
    }
    window.test = test; // <- æ’å…¥åˆ†å·

// ä¸¤è¡Œåˆè¢«åˆå¹¶äº†
})(window)(function(window) {
    window.someLibrary = {}; // <- æ’å…¥åˆ†å·
})(window); //<- æ’å…¥åˆ†å·

```

è§£æå™¨æ˜¾è‘—æ”¹å˜äº†ä¸Šé¢ä»£ç çš„è¡Œä¸ºï¼Œåœ¨å¦å¤–ä¸€äº›æƒ…å†µä¸‹ä¹Ÿä¼šåšå‡ºé”™è¯¯çš„å¤„ç†ã€‚

##### 5.4.3 ECMAScriptå¯¹è‡ªåŠ¨åˆ†å·æ’å…¥çš„è§„åˆ™

æˆ‘ä»¬ç¿»åˆ°7.9ç« èŠ‚ï¼Œçœ‹çœ‹å…¶ä¸­æ’å…¥åˆ†å·çš„æœºåˆ¶å’ŒåŸç†ï¼Œæ¸…æ¥šåªå†™ä»¥åå°±å¯ä»¥å°½é‡ä»¥åå°‘è¸©å‘

**å¿…é¡»ç”¨åˆ†å·ç»ˆæ­¢æŸäº› ECMAScript è¯­å¥ ( ç©ºè¯­å¥ , å˜é‡å£°æ˜è¯­å¥ , è¡¨è¾¾å¼è¯­å¥ , do-while è¯­å¥ , continue è¯­å¥ , break è¯­å¥ , return è¯­å¥ ,throw è¯­å¥ )ã€‚è¿™äº›åˆ†å·æ€»æ˜¯æ˜ç¡®çš„æ˜¾ç¤ºåœ¨æºæ–‡æœ¬é‡Œã€‚ç„¶è€Œï¼Œä¸ºäº†æ–¹ä¾¿èµ·è§ï¼ŒæŸäº›æƒ…å†µä¸‹è¿™äº›åˆ†å·å¯ä»¥åœ¨æºæ–‡æœ¬é‡Œçœç•¥ã€‚æè¿°è¿™ç§æƒ…å†µä¼šè¯´ï¼šè¿™ç§æƒ…å†µä¸‹ç»™æºä»£ç çš„ token æµè‡ªåŠ¨æ’å…¥åˆ†å·ã€‚**â€¨â€¨[![img](https://camo.githubusercontent.com/d0dd45ca6894c705cb2e2444ac1107c6203be0fe/687474703a2f2f7777312e73696e61696d672e636e2f6c617267652f6136363063616232677931666461336367376472686a3231696f306c61746862)](https://camo.githubusercontent.com/d0dd45ca6894c705cb2e2444ac1107c6203be0fe/687474703a2f2f7777312e73696e61696d672e636e2f6c617267652f6136363063616232677931666461336367376472686a3231696f306c61746862)
[![img](https://camo.githubusercontent.com/de4c5635fd11dc26956ad2e0b5c5971ff178edae/687474703a2f2f7777312e73696e61696d672e636e2f6c617267652f613636306361623267793166646133636f646974616a32316477306969616731)](https://camo.githubusercontent.com/de4c5635fd11dc26956ad2e0b5c5971ff178edae/687474703a2f2f7777312e73696e61696d672e636e2f6c617267652f613636306361623267793166646133636f646974616a32316477306969616731)

è¿˜æ˜¯æ¯”è¾ƒæŠ½è±¡ï¼Œçœ‹ä¸å¤ªæ‡‚æ˜¯ä¸æ˜¯ï¼Œä¸è¦ç´§ï¼Œæˆ‘ä»¬çœ‹çœ‹å®é™…ä¾‹å­ï¼Œæ€»ç»“å‡ºå‡ ä¸ªè§„å¾‹å°±è¡Œï¼Œæˆ‘ä»¬å…ˆä¸çœ‹æŠ½è±¡çš„ï¼Œçœ‹ç€å¤´æ™•ï¼Œçœ‹çœ‹å…·ä½“çš„æ€»ç»“è¯´æ˜ï¼Œ **åŒ–æŠ½è±¡ä¸ºå…·ä½“** ã€‚

é¦–å…ˆè¿™äº›è§„åˆ™æ˜¯åŸºäºä¸¤ç‚¹ï¼š

1. ä»¥æ¢è¡Œä¸ºåŸºç¡€ï¼›
2. è§£æå™¨ä¼šå°½é‡å°†æ–°è¡Œå¹¶å…¥å½“å‰è¡Œï¼Œå½“ä¸”ä»…å½“ç¬¦åˆASIè§„åˆ™æ—¶æ‰ä¼šå°†æ–°è¡Œè§†ä¸ºç‹¬ç«‹çš„è¯­å¥ã€‚

###### 5.4.3.1 ASIçš„è§„åˆ™

**1. æ–°è¡Œå¹¶å…¥å½“å‰è¡Œå°†æ„æˆéæ³•è¯­å¥ï¼Œè‡ªåŠ¨æ’å…¥åˆ†å·ã€‚**

```
if(1 < 10) a = 1
console.log(a)
// ç­‰ä»·äº
if(1 < 10) a = 1;
console.log(a);
```

**2. åœ¨continue,return,break,throwåè‡ªåŠ¨æ’å…¥åˆ†å·**

```
return
{a: 1}
// ç­‰ä»·äº
return;
{a: 1};
```

**3. ++ã€--åç¼€è¡¨è¾¾å¼ä½œä¸ºæ–°è¡Œçš„å¼€å§‹ï¼Œåœ¨è¡Œé¦–è‡ªåŠ¨æ’å…¥åˆ†å·**

```
a
++
c
// ç­‰ä»·äº
a;
++c;
```

**4. ä»£ç å—çš„æœ€åä¸€ä¸ªè¯­å¥ä¼šè‡ªåŠ¨æ’å…¥åˆ†å·**

```
function(){ a = 1 }
// ç­‰ä»·äº
function(){ a = 1; }
```

###### 5.4.3.2 No ASIçš„è§„åˆ™

**1. æ–°è¡Œä»¥ ( å¼€å§‹**

```
var a = 1
var b = a
(a+b).toString()
// ä¼šè¢«è§£æä¸ºä»¥a+bä¸ºå…¥å‚è°ƒç”¨å‡½æ•°aï¼Œç„¶åè°ƒç”¨å‡½æ•°è¿”å›å€¼çš„toStringå‡½æ•°
var a = 1
var b =a(a+b).toString()
```

**2. æ–°è¡Œä»¥ [ å¼€å§‹**

```
var a = ['a1', 'a2']
var b = a
[0,1].slice(1)
// ä¼šè¢«è§£æå…ˆè·å–a[1]ï¼Œç„¶åè°ƒç”¨a[1].slice(1)ã€‚
// ç”±äºé€—å·ä½äº[]å†…ï¼Œä¸”ä¸è¢«è§£æä¸ºæ•°ç»„å­—é¢é‡ï¼Œè€Œè¢«è§£æä¸ºè¿ç®—ç¬¦ï¼Œè€Œé€—å·è¿ç®—ç¬¦ä¼šå…ˆæ‰§
è¡Œå·¦ä¾§è¡¨è¾¾å¼ï¼Œç„¶åæ‰§è¡Œå³ä¾§è¡¨è¾¾å¼å¹¶ä¸”ä»¥å³ä¾§è¡¨è¾¾å¼çš„è®¡ç®—ç»“æœä½œä¸ºè¿”å›å€¼
var a = ['a1', 'a2']
var b = a[0,1].slice(1)
```

**3. æ–°è¡Œä»¥ / å¼€å§‹**

```
var a = 1
var b = a
/test/.test(b)
// /ä¼šè¢«è§£æä¸ºæ•´é™¤è¿ç®—ç¬¦ï¼Œè€Œä¸æ˜¯æ­£åˆ™è¡¨è¾¾å¼å­—é¢é‡çš„èµ·å§‹ç¬¦å·ã€‚æµè§ˆå™¨ä¸­ä¼šæŠ¥testå‰å¤šäº†ä¸ª.å·
var a = 1
var b = a / test / .test(b)

```

**4. æ–°è¡Œä»¥ + ã€ - ã€ % å’Œ \* å¼€å§‹**

```
var a = 2
var b = a
+a
// ä¼šè§£æå¦‚ä¸‹æ ¼å¼
var a = 2
var b = a + a
```

**5. æ–°è¡Œä»¥ , æˆ– . å¼€å§‹**

```
var a = 2
var b = a
.toString()
console.log(typeof b)
// ä¼šè§£æä¸º
var a = 2
var b = a.toString()
console.log(typeof b)
```

åˆ°è¿™é‡Œæˆ‘ä»¬å·²ç»å¯¹ASIçš„è§„åˆ™æœ‰ä¸€å®šçš„äº†è§£äº†ï¼Œå¦å¤–è¿˜æœ‰ä¸€æ ·æœ‰è¶£çš„äº‹æƒ…ï¼Œå°±æ˜¯â€œç©ºè¯­å¥â€ã€‚

```
// ä¸‰ä¸ªç©ºè¯­å¥
;;;

// åªæœ‰ifæ¡ä»¶è¯­å¥ï¼Œè¯­å¥å—ä¸ºç©ºè¯­å¥ã€‚
// å¯å®ç°unlessæ¡ä»¶è¯­å¥çš„æ•ˆæœ
if(1>2);else
  console.log('2 is greater than 1 always!');

// åªæœ‰whileæ¡ä»¶è¯­å¥ï¼Œå¾ªç¯ä½“ä¸ºç©ºè¯­å¥ã€‚
var a = 1
while(++a < 100);
```

##### 5.4.4 ç»“è®º

å»ºè®®ç»å¯¹ä¸è¦çœç•¥åˆ†å·ï¼ŒåŒæ—¶ä¹Ÿæå€¡å°†èŠ±æ‹¬å·å’Œç›¸åº”çš„è¡¨è¾¾å¼æ”¾åœ¨ä¸€è¡Œï¼Œ å¯¹äºåªæœ‰ä¸€è¡Œä»£ç çš„ if æˆ–è€… else è¡¨è¾¾å¼ï¼Œä¹Ÿä¸åº”è¯¥çœç•¥èŠ±æ‹¬å·ã€‚ è¿™äº›è‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ä¸ä»…å¯ä»¥æåˆ°ä»£ç çš„ä¸€è‡´æ€§ï¼Œè€Œä¸”å¯ä»¥é˜²æ­¢è§£æå™¨æ”¹å˜ä»£ç è¡Œä¸ºçš„é”™è¯¯å¤„ç†ã€‚
â€¨[å…³äºJavaScript è¯­å¥ååº”è¯¥åŠ åˆ†å·ä¹ˆï¼Ÿ(ç‚¹æˆ‘æŸ¥çœ‹)](https://www.zhihu.com/question/20298345)æˆ‘ä»¬å¯ä»¥çœ‹çœ‹çŸ¥ä¹ä¸Šå¤§ç‰›ä»¬å¯¹ç€ä¸ªé—®é¢˜çš„çœ‹æ³•ã€‚

**ä½ å¯èƒ½ä¸çŸ¥é“çš„å‰ç«¯çŸ¥è¯†ç‚¹ï¼šåŸæ¥ JavaScript è¿˜æœ‰ä½æ“ä½œä»¥åŠåˆ†å·çš„ä½¿ç”¨ç»†åˆ™**

### 6ã€å°† argruments å¯¹è±¡(ç±»æ•°ç»„)è½¬æ¢æˆæ•°ç»„

`{0:1,1:2,2:3,length:3}`è¿™ç§å½¢å¼çš„å°±å±äºç±»æ•°ç»„ï¼Œå°±æ˜¯æŒ‰ç…§æ•°ç»„ä¸‹æ ‡æ’åºçš„å¯¹è±¡ï¼Œè¿˜æœ‰ä¸€ä¸ª `length`å±æ€§ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦è¿™ç§å¯¹è±¡èƒ½è°ƒç”¨æ•°ç»„ä¸‹çš„ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™æ—¶å€™å°±éœ€è¦æŠŠæŠŠç±»æ•°ç»„è½¬åŒ–æˆçœŸæ­£çš„æ•°ç»„ã€‚

#### 6.1 æ™®é€šç‰ˆ

```
var makeArray = function(array) {
  var ret = []
  if (array != null) {
    var i = array.length
    if (i == null || typeof array === "string") ret[0] = array
    else while (i) ret[--i] = array[i];
  }
  return ret
}
makeArray({0:1,1:2,2:3,length:3}) //[1,2,3]
```

ä¼˜ç‚¹ï¼šé€šç”¨ç‰ˆæœ¬ï¼Œæ²¡æœ‰ä»»ä½•å…¼å®¹æ€§é—®é¢˜
ç¼ºç‚¹ï¼šå¤ªæ™®é€š

#### 6.2 è¿›é˜¶ç‰ˆ

```
var arr = Array.prototype.slice.call(arguments);
```

è¿™ç§åº”è¯¥æ˜¯å¤§å®¶ç”¨è¿‡æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼Œè‡³äºä¸ºä»€ä¹ˆå¯ä»¥è¿™ä¹ˆç”¨ï¼Œå¾ˆå¤šäººä¼°è®¡ä¹Ÿæ˜¯ä¸€çŸ¥åŠè§£ï¼Œåæ­£æˆ‘çœ‹è§å¤§å®¶è¿™ä¹ˆç”¨æˆ‘ä¹Ÿè¿™ä¹ˆç”¨ï¼Œè¦ææ¸…ä¸ºä»€ä¹ˆé‡Œé¢çš„åŸå› ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä»è§„èŒƒå’Œæºç è¯´èµ·ã€‚

ç…§ç€è§„èŒƒçš„æµç¨‹ï¼Œè‡ªå·±çœ‹çœ‹æ¨æ¼”ä¸€ä¸‹å°±æ˜ç™½äº†ï¼š
[è‹±æ–‡ç‰ˆ15.4.4.10 Array.prototype.slice (start, end) ](http://es5.github.io/#x15.4.4.10)
[ä¸­æ–‡ç‰ˆ15.4.4.10 Array.prototype.slice (start, end) ](http://yanhaijing.com/es5/#352)
å¦‚æœä½ æƒ³çŸ¥é“ `JavaScript` çš„ `sort` æ’åºçš„æœºåˆ¶ï¼Œåˆ°åº•æ˜¯å“ªç§æ’åºå¥½ï¼Œç”¨çš„å“ªç§ï¼Œä¹Ÿå¯ä»¥ä»è§„èŒƒçœ‹å‡ºç«¯å€ªã€‚

åœ¨å®˜æ–¹çš„è§£é‡Šä¸­ï¼Œå¦‚[[mdn](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice)]

> The slice() method returns a shallow copy of a portion of an array into a new array object.

**ç®€å•çš„è¯´å°±æ˜¯æ ¹æ®å‚æ•°ï¼Œè¿”å›æ•°ç»„çš„ä¸€éƒ¨åˆ†çš„ copyã€‚æ‰€ä»¥äº†è§£å…¶å†…éƒ¨å®ç°æ‰èƒ½ç¡®å®šå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æ‰€ä»¥æŸ¥çœ‹ V8 æºç ä¸­çš„ Array.js å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„ä»£ç ï¼š**

æ–¹æ³• `ArraySlice`ï¼Œ[æºç åœ°å€](https://github.com/v8/v8/blob/ad82a40509c5b5b4680d4299c8f08d6c6d31af3c/src/js/array.js)ï¼Œç¬¬ `660` è¡Œ,ç›´æ¥æ·»åŠ åˆ° `Array.prototype` ä¸Šçš„â€œå…¥å£â€ï¼Œå†…éƒ¨ç»è¿‡å‚æ•°ã€ç±»å‹ç­‰ç­‰çš„åˆ¤æ–­å¤„ç†ï¼Œåˆ†æ”¯ä¸º `SparseSlice` å’Œ `SimpleSlice` å¤„ç†ã€‚

`slice.call` çš„ä½œç”¨åŸç†å°±æ˜¯ï¼Œåˆ©ç”¨ `call`ï¼Œå°† `slice` çš„æ–¹æ³•ä½œç”¨äº `arrayLike`ï¼Œ`slice` çš„ä¸¤ä¸ªå‚æ•°ä¸ºç©ºï¼Œ`slice` å†…éƒ¨è§£æä½¿å¾— `arguments.lengt` ç­‰äº0çš„æ—¶å€™ ç›¸å½“äºå¤„ç† `slice(0)` ï¼š å³é€‰æ‹©æ•´ä¸ªæ•°ç»„ï¼Œ`slice` æ–¹æ³•å†…éƒ¨æ²¡æœ‰å¼ºåˆ¶åˆ¤æ–­å¿…é¡»æ˜¯ `Array` ç±»å‹ï¼Œ`slice` è¿”å›çš„æ˜¯æ–°å»ºçš„æ•°ç»„ï¼ˆä½¿ç”¨å¾ªç¯å–å€¼ï¼‰â€ï¼Œæ‰€ä»¥è¿™æ ·å°±å®ç°äº†ç±»æ•°ç»„åˆ°æ•°ç»„çš„è½¬åŒ–ï¼Œ`call` è¿™ä¸ªç¥å¥‡çš„æ–¹æ³•ã€`slice` çš„å¤„ç†ç¼ºä¸€ä¸å¯ã€‚

ç›´æ¥çœ‹ `slice` æ€ä¹ˆå®ç°çš„å§ã€‚å…¶å®å°±æ˜¯å°† `array-like` å¯¹è±¡é€šè¿‡ä¸‹æ ‡æ“ä½œæ”¾è¿›äº†æ–°çš„ `Array` é‡Œé¢ï¼š

```
// This will work for genuine arrays, array-like objects, 
    // NamedNodeMap (attributes, entities, notations),
    // NodeList (e.g., getElementsByTagName), HTMLCollection (e.g., childNodes),
    // and will not fail on other DOM objects (as do DOM elements in IE < 9)
    Array.prototype.slice = function(begin, end) {
      // IE < 9 gets unhappy with an undefined end argument
      end = (typeof end !== 'undefined') ? end : this.length;

      // For native Array objects, we use the native slice function
      if (Object.prototype.toString.call(this) === '[object Array]'){
        return _slice.call(this, begin, end); 
      }

      // For array like object we handle it ourselves.
      var i, cloned = [],
        size, len = this.length;

      // Handle negative value for "begin"
      var start = begin || 0;
      start = (start >= 0) ? start : Math.max(0, len + start);

      // Handle negative value for "end"
      var upTo = (typeof end == 'number') ? Math.min(end, len) : len;
      if (end < 0) {
        upTo = len + end;
      }

      // Actual expected size of the slice
      size = upTo - start;

      if (size > 0) {
        cloned = new Array(size);
        if (this.charAt) {
          for (i = 0; i < size; i++) {
            cloned[i] = this.charAt(start + i);
          }
        } else {
          for (i = 0; i < size; i++) {
            cloned[i] = this[start + i];
          }
        }
      }

      return cloned;
    };
```

ä¼˜ç‚¹ï¼šæœ€å¸¸ç”¨çš„ç‰ˆæœ¬ï¼Œå…¼å®¹æ€§è¾ƒå¼º
ç¼ºç‚¹ï¼šie ä½ç‰ˆæœ¬ï¼Œæ— æ³•å¤„ç† dom é›†åˆçš„ slice call è½¬æ•°ç»„ã€‚ï¼ˆè™½ç„¶å…·æœ‰æ•°å€¼é”®å€¼ã€length ç¬¦åˆArrayLike çš„å®šä¹‰ï¼Œå´æŠ¥é”™ï¼‰æœç´¢èµ„æ–™å¾—åˆ° ï¼šå› ä¸º ie ä¸‹çš„ dom å¯¹è±¡æ˜¯ä»¥ com å¯¹è±¡çš„å½¢å¼å®ç°çš„ï¼Œjs å¯¹è±¡ä¸comå¯¹è±¡ä¸èƒ½è¿›è¡Œè½¬æ¢ ã€‚

#### 6.3 ES6 ç‰ˆæœ¬

ä½¿ç”¨ `Array.from`, å€¼éœ€è¦å¯¹è±¡æœ‰ `length` å±æ€§, å°±å¯ä»¥è½¬æ¢æˆæ•°ç»„

```
var arr = Array.from(arguments);
```

æ‰©å±•è¿ç®—ç¬¦

```
var args = [...arguments];
```

`ES6` ä¸­çš„æ‰©å±•è¿ç®—ç¬¦...ä¹Ÿèƒ½å°†æŸäº›æ•°æ®ç»“æ„è½¬æ¢æˆæ•°ç»„ï¼Œè¿™ç§æ•°æ®ç»“æ„å¿…é¡»æœ‰ä¾¿åˆ©å™¨æ¥å£ã€‚
ä¼˜ç‚¹ï¼šç›´æ¥ä½¿ç”¨å†…ç½® APIï¼Œç®€å•æ˜“ç»´æŠ¤
ç¼ºç‚¹ï¼šå…¼å®¹æ€§ï¼Œä½¿ç”¨ babel çš„ profill è½¬åŒ–å¯èƒ½ä½¿ä»£ç å˜å¤šï¼Œæ–‡ä»¶åŒ…å˜å¤§

**ä½ å¯èƒ½ä¸çŸ¥é“çš„å‰ç«¯çŸ¥è¯†ç‚¹ï¼šslice æ–¹æ³•çš„å…·ä½“åŸç†**

### 7ã€æ•°å­—å–æ•´ 2.33333 => 2

#### 7.1 æ™®é€šç‰ˆ

```
const a = parseInt(2.33333)
```

`parseInt()` å‡½æ•°è§£æä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å®šåŸºæ•°çš„æ•´æ•° (æ•°å­¦ç³»ç»Ÿçš„åŸºç¡€)ã€‚è¿™ä¸ªä¼°è®¡æ˜¯ç›´æ¥å–æ•´æœ€å¸¸ç”¨çš„æ–¹æ³•äº†ã€‚
æ›´å¤šå…³äº `parseInt()` å‡½æ•°å¯ä»¥æŸ¥çœ‹ [MDN æ–‡æ¡£](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/parseInt)

#### 7.2 è¿›é˜¶ç‰ˆ

```
const a = Math.trunc(2.33333)
```

`Math.trunc()` æ–¹æ³•ä¼šå°†æ•°å­—çš„å°æ•°éƒ¨åˆ†å»æ‰ï¼Œåªä¿ç•™æ•´æ•°éƒ¨åˆ†ã€‚
ç‰¹åˆ«è¦æ³¨æ„çš„æ˜¯ï¼š`Internet Explorer` ä¸æ”¯æŒè¿™ä¸ªæ–¹æ³•ï¼Œä¸è¿‡å†™ä¸ª `Polyfill` ä¹Ÿå¾ˆç®€å•ï¼š

```
Math.trunc = Math.trunc || function(x) {
  if (isNaN(x)) {
    return NaN;
  }
  if (x > 0) {
    return Math.floor(x);
  }
  return Math.ceil(x);
};
```

æ•°å­¦çš„äº‹æƒ…è¿˜æ˜¯ç”¨æ•°å­¦æ–¹æ³•æ¥å¤„ç†æ¯”è¾ƒå¥½ã€‚

#### 7.3 é»‘ç§‘æŠ€ç‰ˆ

##### 7.3.1 ~~number

åŒæ³¢æµªçº¿ ~~ æ“ä½œç¬¦ä¹Ÿè¢«ç§°ä¸ºâ€œåŒæŒ‰ä½éâ€æ“ä½œç¬¦ã€‚ä½ é€šå¸¸å¯ä»¥ä½¿ç”¨å®ƒä½œä¸ºä»£æ›¿ Math.trunc() çš„æ›´å¿«çš„æ–¹æ³•ã€‚

```
console.log(~~47.11)  // -> 47
console.log(~~1.9999) // -> 1
console.log(~~3)      // -> 3
console.log(~~[])     // -> 0
console.log(~~NaN)    // -> 0
console.log(~~null)   // -> 0
```

å¤±è´¥æ—¶è¿”å›0,è¿™å¯èƒ½åœ¨è§£å†³ Math.trunc() è½¬æ¢é”™è¯¯è¿”å› NaN æ—¶æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ›¿ä»£ã€‚
ä½†æ˜¯å½“æ•°å­—èŒƒå›´è¶…å‡º Â±2^31âˆ’1 å³ï¼š2147483647 æ—¶ï¼Œå¼‚å¸¸å°±å‡ºç°äº†ï¼š

```
// å¼‚å¸¸æƒ…å†µ
console.log(~~2147493647.123) // -> -2147473649 ğŸ™
```

##### 7.3.2 number | 0

| (æŒ‰ä½æˆ–) å¯¹æ¯ä¸€å¯¹æ¯”ç‰¹ä½æ‰§è¡Œæˆ–ï¼ˆORï¼‰æ“ä½œã€‚

```
console.log(20.15|0);          // -> 20
console.log((-20.15)|0);       // -> -20
console.log(3000000000.15|0);  // -> -1294967296 ğŸ™
```

##### 7.3.3 number ^ 0

^ (æŒ‰ä½å¼‚æˆ–)ï¼Œå¯¹æ¯ä¸€å¯¹æ¯”ç‰¹ä½æ‰§è¡Œå¼‚æˆ–ï¼ˆXORï¼‰æ“ä½œã€‚

```
console.log(20.15^0);          // -> 20
console.log((-20.15)^0);       // -> -20
console.log(3000000000.15^0);  // -> -1294967296 ğŸ™
```

##### 7.3.4 number << 0

<< (å·¦ç§») æ“ä½œç¬¦ä¼šå°†ç¬¬ä¸€ä¸ªæ“ä½œæ•°å‘å·¦ç§»åŠ¨æŒ‡å®šçš„ä½æ•°ã€‚å‘å·¦è¢«ç§»å‡ºçš„ä½è¢«ä¸¢å¼ƒï¼Œå³ä¾§ç”¨ 0 è¡¥å……ã€‚

```
console.log(20.15 < < 0);     // -> 20
console.log((-20.15) < < 0);  //-20
console.log(3000000000.15 << 0);  // -> -1294967296 ğŸ™
```

ä¸Šé¢è¿™äº›æŒ‰ä½è¿ç®—ç¬¦æ–¹æ³•æ‰§è¡Œå¾ˆå¿«ï¼Œå½“ä½ æ‰§è¡Œæ•°ç™¾ä¸‡è¿™æ ·çš„æ“ä½œéå¸¸é€‚ç”¨ï¼Œé€Ÿåº¦æ˜æ˜¾ä¼˜äºå…¶ä»–æ–¹æ³•ã€‚ä½†æ˜¯ä»£ç çš„å¯è¯»æ€§æ¯”è¾ƒå·®ã€‚è¿˜æœ‰ä¸€ä¸ªç‰¹åˆ«è¦æ³¨æ„çš„åœ°æ–¹ï¼Œå¤„ç†æ¯”è¾ƒå¤§çš„æ•°å­—æ—¶ï¼ˆå½“æ•°å­—èŒƒå›´è¶…å‡º Â±2^31âˆ’1 å³ï¼š2147483647ï¼‰ï¼Œä¼šæœ‰ä¸€äº›å¼‚å¸¸æƒ…å†µã€‚ä½¿ç”¨çš„æ—¶å€™æ˜ç¡®çš„æ£€æŸ¥è¾“å…¥æ•°å€¼çš„èŒƒå›´ã€‚

### 8ã€æ•°ç»„æ±‚å’Œ

#### 8.1 æ™®é€šç‰ˆ

```
let arr = [1, 2, 3, 4, 5]
function sum(arr){
    let x = 0
    for(let i = 0; i < arr.length; i++){
        x += arr[i]
    }
    return x
}
sum(arr) // 15
```

ä¼˜ç‚¹ï¼šé€šä¿—æ˜“æ‡‚ï¼Œç®€å•ç²—æš´
ç¼ºç‚¹ï¼šæ²¡æœ‰äº®ç‚¹ï¼Œå¤ªé€šä¿—

#### 8.2 ä¼˜é›…ç‰ˆ

```
let arr = [1, 2, 3, 4, 5]
function sum(arr) {
return arr.reduce((a, b) => a + b)
}
sum(arr) //15
```

ä¼˜ç‚¹ï¼šç®€å•æ˜äº†ï¼Œæ•°ç»„è¿­ä»£å™¨æ–¹å¼æ¸…æ™°ç›´è§‚
ç¼ºç‚¹ï¼šä¸å…¼å®¹ IE 9ä»¥ä¸‹æµè§ˆå™¨

#### 8.3 ç»ˆæç‰ˆ

```
let arr = [1, 2, 3, 4, 5]
function sum(arr) {
return eval(arr.join("+"))
}
sum(arr) //15
```

ä¼˜ç‚¹ï¼šè®©äººä¸€æ—¶çœ‹ä¸æ‡‚çš„å°±æ˜¯"å¥½æ–¹æ³•"ã€‚
ç¼ºç‚¹ï¼š

> eval ä¸å®¹æ˜“è°ƒè¯•ã€‚ç”¨ chromeDev ç­‰è°ƒè¯•å·¥å…·æ— æ³•æ‰“æ–­ç‚¹è°ƒè¯•ï¼Œæ‰€ä»¥éº»çƒ¦çš„ä¸œè¥¿ä¹Ÿæ˜¯ä¸æ¨èä½¿ç”¨çš„â€¦

> æ€§èƒ½é—®é¢˜ï¼Œåœ¨æ—§çš„æµè§ˆå™¨ä¸­å¦‚æœä½ ä½¿ç”¨äº†evalï¼Œæ€§èƒ½ä¼šä¸‹é™10å€ã€‚åœ¨ç°ä»£æµè§ˆå™¨ä¸­æœ‰ä¸¤ç§ç¼–è¯‘æ¨¡å¼ï¼šfast pathå’Œslow pathã€‚fast pathæ˜¯ç¼–è¯‘é‚£äº›ç¨³å®šå’Œå¯é¢„æµ‹ï¼ˆstable and predictableï¼‰çš„ä»£ç ã€‚è€Œæ˜æ˜¾çš„ï¼Œeval ä¸å¯é¢„æµ‹ï¼Œæ‰€ä»¥å°†ä¼šä½¿ç”¨ slow path ï¼Œæ‰€ä»¥ä¼šæ…¢ã€‚

æ›´å¤šå…³äº `eval` çš„æ¢è®¨å¯ä»¥å…³æ³¨è¿™ç¯‡æ–‡ç« : [JavaScript ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨ evalï¼Ÿ](https://www.zhihu.com/question/20591877)

**ä½ å¯èƒ½ä¸çŸ¥é“çš„å‰ç«¯çŸ¥è¯†ç‚¹ï¼ševalçš„ä½¿ç”¨ç»†åˆ™**

### æœ€å

**ç¥å¤§å®¶åœ£è¯å¿«ä¹ğŸ„ï¼Œæ¬¢è¿è¡¥å……å’Œäº¤æµã€‚**
[![img](https://camo.githubusercontent.com/04fbd9fcac2bc85994dfebb6d74f15d8206c6085/68747470733a2f2f7773332e73696e61696d672e636e2f6c617267652f303036744e625277677931666d716f6e72756c74736a33306e6930736d6469682e6a7067)](https://camo.githubusercontent.com/04fbd9fcac2bc85994dfebb6d74f15d8206c6085/68747470733a2f2f7773332e73696e61696d672e636e2f6c617267652f303036744e625277677931666d716f6e72756c74736a33306e6930736d6469682e6a7067)
[![img](https://camo.githubusercontent.com/f61d61eaa203b60ecb1348ca1e1a1c7f7c17b2d6/68747470733a2f2f7773322e73696e61696d672e636e2f6c617267652f303036744e625277677931666d716f6e79707267396a3330763030747971676b2e6a7067)](https://camo.githubusercontent.com/f61d61eaa203b60ecb1348ca1e1a1c7f7c17b2d6/68747470733a2f2f7773322e73696e61696d672e636e2f6c617267652f303036744e625277677931666d716f6e79707267396a3330763030747971676b2e6a7067)
[![img](https://camo.githubusercontent.com/fd730490d0130d97a98b9695d73fde1c34825f59/68747470733a2f2f7773342e73696e61696d672e636e2f6c617267652f303036744e625277677931666d716f6f706b74646a67333064773037713777682e676966)](https://camo.githubusercontent.com/fd730490d0130d97a98b9695d73fde1c34825f59/68747470733a2f2f7773342e73696e61696d672e636e2f6c617267652f303036744e625277677931666d716f6f706b74646a67333064773037713777682e676966)